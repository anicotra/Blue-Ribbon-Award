<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blue Ribbon Award Nominations</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); min-height: 100vh; color: #333; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; color: white; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.1rem; opacity: 0.9; }
        .form-container, .admin-container { background: white; border-radius: 15px; padding: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .form-group { margin-bottom: 25px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; color: #2c3e50; }
        .required { color: #e74c3c; }
        .form-group input, .form-group textarea { width: 100%; padding: 12px 15px; border: 2px solid #e1e8ed; border-radius: 8px; font-size: 16px; transition: all 0.3s ease; }
        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #4facfe; box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1); }
        .form-group textarea { min-height: 120px; resize: vertical; }
        .submit-btn, .admin-btn, .export-btn, .delete-btn { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 15px 30px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px; }
        .submit-btn:hover, .admin-btn:hover, .export-btn:hover, .delete-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3); }
        .admin-toggle { position: fixed; top: 20px; right: 20px; z-index: 1000; }
        .admin-container { display: none; }
        .admin-container.active { display: block; }
        .submissions-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .submissions-table th, .submissions-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .submissions-table th { background: #f8f9fa; font-weight: 600; color: #2c3e50; }
        .submission-row:hover { background: #e3f2fd; cursor: pointer; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: white; margin: 5% auto; padding: 30px; border-radius: 15px; width: 80%; max-width: 600px; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; line-height: 1; }
        .close:hover { color: #000; }
        .modal-field { margin-bottom: 15px; }
        .modal-field strong { color: #2c3e50; display: block; margin-bottom: 5px; }
        .vote-bar { background: #e9ecef; height: 20px; border-radius: 10px; overflow: hidden; margin: 5px 0; }
        .vote-fill { background: linear-gradient(90deg, #28a745, #20c997); height: 100%; transition: width 0.3s ease; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: bold; }
        .admin-controls { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .date-filter { padding: 8px 12px; border: 2px solid #e1e8ed; border-radius: 6px; font-size: 14px; }
        .export-btn { background: linear-gradient(135deg, #28a745, #20c997); }
        .delete-btn { background: linear-gradient(135deg, #dc3545, #c82333); }
        .stats-card { background: linear-gradient(135deg, #17a2b8, #138496); color: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: center; }
        .stats-card h3 { margin-bottom: 10px; }
        .success-message { background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #c3e6cb; }
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .form-container, .admin-container { padding: 20px; }
            .header h1 { font-size: 2rem; }
            .admin-controls { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="admin-toggle">
        <button id="adminToggleBtn" class="admin-btn" type="button">Admin Panel</button>
    </div>
    <div class="container">
        <div class="header">
            <h1>Blue Ribbon Award Nominations</h1>
            <p>The Blue Ribbon Award aims to acknowledge and celebrate exceptional performance, dedication, and contributions of our team at MPB.</p>
        </div>

        <div id="nominationForm" class="form-container">
            <form id="submissionForm">
                <div class="form-group">
                    <label for="nominee">1. Who would you like to nominate for the Blue Ribbon Award? <span class="required">*</span></label>
                    <input type="text" id="nominee" name="nominee" required>
                </div>
                <div class="form-group">
                    <label for="description">2. Please describe the specific attributes or accomplishments that led you to nominate this individual. <span class="required">*</span></label>
                    <textarea id="description" name="description" required placeholder="Describe the exceptional performance..."></textarea>
                </div>
                <button type="submit" class="submit-btn">Submit</button>
            </form>
            <div id="successMessage" class="success-message" style="display: none;">
                Thank you! Your nomination has been submitted successfully.
            </div>
        </div>

        <div id="adminPanel" class="admin-container">
            <div id="adminLogin" class="login-form">
                <h2>Admin Login</h2>
                <div class="form-group">
                    <label for="adminPassword">Password:</label>
                    <input type="password" id="adminPassword" placeholder="Enter admin password">
                </div>
                <button id="adminLoginBtn" class="admin-btn" type="button">Login</button>
            </div>

            <div id="adminDashboard" style="display: none;">
                <h2>Admin Dashboard</h2>
                <div class="stats-card">
                    <h3>Total Submissions</h3>
                    <p id="totalSubmissions">0</p>
                </div>
                <div class="sharepoint-integration">
                    <h4>SharePoint Integration</h4>
                    <p>Vote counts are synced with SharePoint. The bars below show current vote tallies for each nominee.</p>
                    <p><a href="https://mpbcpa.sharepoint.com/sites/MPB" target="_blank">Open SharePoint Site</a></p>
                </div>
                <div class="admin-controls">
                    <input type="date" id="dateFrom" class="date-filter" title="Filter from date">
                    <input type="date" id="dateTo" class="date-filter" title="Filter to date">
                    <button id="filterBtn" class="admin-btn" type="button">Filter</button>
                    <button id="exportBtn" class="export-btn" type="button">Export CSV</button>
                    <button id="deleteAllBtn" class="delete-btn" type="button">Delete All</button>
                </div>
                <div id="submissionsContainer">
                    <table class="submissions-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Nominee</th>
                                <th>Description</th>
                                <th>Votes</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="submissionsBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="submissionModal" class="modal">
            <div class="modal-content">
                <span id="modalCloseBtn" class="close">&times;</span>
                <h3>Submission Details</h3>
                <div id="modalContent"></div>
            </div>
        </div>
    </div>

    <script>
        let submissions = [];
        let isAdminLoggedIn = false;
        const ADMIN_PASSWORD = 'admin123';
        const sharepointVotes = {
            'John Smith': 15,
            'Sarah Johnson': 23,
            'Mike Wilson': 8,
            'Emma Davis': 31,
            'Tom Brown': 12
        };

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('submissionForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('adminToggleBtn').addEventListener('click', toggleAdmin);
            document.getElementById('adminLoginBtn').addEventListener('click', adminLogin);
            document.getElementById('filterBtn').addEventListener('click', filterSubmissions);
            document.getElementById('exportBtn').addEventListener('click', exportData);
            document.getElementById('deleteAllBtn').addEventListener('click', deleteAllSubmissions);
            document.getElementById('modalCloseBtn').addEventListener('click', closeModal);
            document.getElementById('adminPassword').addEventListener('keypress', e => { if (e.key === 'Enter') adminLogin(); });

            // Sample data
            submissions = [
                { id: 1, date: '2025-07-25', nominee: 'Sarah Johnson', description: 'Consistently goes above and beyond in project management, leading cross-functional teams to deliver exceptional results ahead of schedule.', submittedBy: 'Adam', submittedAt: new Date('2025-07-25T10:30:00') },
                { id: 2, date: '2025-07-26', nominee: 'Mike Wilson', description: 'Demonstrates outstanding technical expertise and mentors junior team members, significantly improving team productivity.', submittedBy: 'Adam', submittedAt: new Date('2025-07-26T14:15:00') }
            ];
            updateStats();
        });

        function handleFormSubmit(e) {
            e.preventDefault();
            const nominee = document.getElementById('nominee').value.trim();
            const description = document.getElementById('description').value.trim();
            if (!nominee || !description) { alert('Please fill in all required fields.'); return; }
            const submission = { id: submissions.length + 1, date: new Date().toISOString().split('T')[0], nominee, description, submittedBy: 'Adam', submittedAt: new Date() };
            submissions.push(submission);
            document.getElementById('successMessage').style.display = 'block';
            document.getElementById('submissionForm').reset();
            setTimeout(() => { document.getElementById('successMessage').style.display = 'none'; }, 3000);
            updateStats();
        }

        function toggleAdmin() {
            const adminPanel = document.getElementById('adminPanel');
            const nominationForm = document.getElementById('nominationForm');
            adminPanel.classList.toggle('active');
            nominationForm.style.display = adminPanel.classList.contains('active') ? 'none' : 'block';
            if (adminPanel.classList.contains('active') && !isAdminLoggedIn) {
                document.getElementById('adminLogin').style.display = 'block';
                document.getElementById('adminDashboard').style.display = 'none';
            }
        }

        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                isAdminLoggedIn = true;
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                loadSubmissions();
            } else { alert('Invalid password'); }
        }

        function loadSubmissions(filtered) {
            const tbody = document.getElementById('submissionsBody');
            const dataToShow = filtered || submissions;
            tbody.innerHTML = '';
            dataToShow.forEach(sub => {
                const votes = sharepointVotes[sub.nominee] || 0;
                const maxVotes = Math.max(...Object.values(sharepointVotes));
                const pct = maxVotes > 0 ? (votes / maxVotes) * 100 : 0;
                const row = document.createElement('tr');
                row.className = 'submission-row';
                row.addEventListener('click', () => viewSubmission(sub));
                row.innerHTML = `<td>${sub.date}</td><td>${sub.nominee}</td><td>${sub.description.substring(0,100)}${sub.description.length>100?'...':''}</td><td><div class='vote-bar'><div class='vote-fill' style='width:${pct}%' >${votes}</div></div></td><td></td>`;
                const actionsCell = row.querySelector('td:last-child');
                const delBtn = document.createElement('button');
                delBtn.className = 'delete-btn';
                delBtn.textContent = 'Delete';
                delBtn.type = 'button';
                delBtn.style.padding = '5px 10px';
                delBtn.style.fontSize = '12px';
                delBtn.addEventListener('click', e => { e.stopPropagation(); deleteSubmission(sub.id); });
                actionsCell.appendChild(delBtn);
                tbody.appendChild(row);
            });
        }

        function filterSubmissions() {
            let filtered = submissions;
            const from = document.getElementById('dateFrom').value;
            const to = document.getElementById('dateTo').value;
            if (from) filtered = filtered.filter(s => s.date >= from);
            if (to) filtered = filtered.filter(s => s.date <= to);
            loadSubmissions(filtered);
        }

        function exportData() {
            let data = [...submissions];
            const from = document.getElementById('dateFrom').value;
            const to = document.getElementById('dateTo').value;
            if (from) data = data.filter(s => s.date >= from);
            if (to) data = data.filter(s => s.date <= to);
            if (!data.length) { alert('No data to export.'); return; }
            const headers = ['Date','Nominee','Description','Submitted By','Votes'];
            const rows = [headers.join(',')];
            data.forEach(s => {
                rows.push([
                    s.date,
                    `"${s.nominee.replace(/"/g,'""')}"`,
                    `"${s.description.replace(/"/g,'""')}"`,
                    `"${s.submittedBy}"`,
                    sharepointVotes[s.nominee] || 0
                ].join(','));
            });
            const blob = new Blob([rows.join('\n')], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `blue_ribbon_nominations_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            alert(`Exported ${data.length} records.`);
        }

        function deleteAllSubmissions() {
            if (!confirm('Are you sure you want to delete all submissions?')) return;
            submissions = [];
            loadSubmissions();
            updateStats();
            alert('All submissions have been deleted.');
        }

        function deleteSubmission(id) {
            if (!confirm('Are you sure you want to delete this submission?')) return;
            submissions = submissions.filter(s => s.id !== id);
            loadSubmissions();
            updateStats();
        }

        function updateStats() { document.getElementById('totalSubmissions').textContent = submissions.length; }
        function viewSubmission(sub) {
            const modal = document.getElementById('submissionModal');
            const content = document.getElementById('modalContent');
            const votes = sharepointVotes[sub.nominee] || 0;
            content.innerHTML = `
                <div class='modal-field'><strong>Date Submitted:</strong>${sub.date}</div>
                <div class='modal-field'><strong>Nominee:</strong>${sub.nominee}</div>
                <div class='modal-field'><strong>Submitted By:</strong>${sub.submittedBy}</div>
                <div class='modal-field'><strong>Current Votes:</strong>${votes}</div>
                <div class='modal-field'><strong>Full Description:</strong><p style='margin-top:10px;line-height:1.6;color:#444;'>${sub.description}</p></div>
                <div class='modal-field'><strong>Submission Time:</strong>${sub.submittedAt.toLocaleString()}</div>
            `;
            modal.style.display = 'block';
        }
        function closeModal() { document.getElementById('submissionModal').style.display = 'none'; }
        window.addEventListener('click', e => { if (e.target === document.getElementById('submissionModal')) closeModal(); });
    </script>
</body>
</html>
